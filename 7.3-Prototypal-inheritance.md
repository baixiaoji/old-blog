# 原型继承

编程中，我们经常想拿一些东西去继承一些东西。

举个例子，我有`user`这个对象，对象上有一些属性与方法；然后我就想稍微的改一下`user`对象，便生成`admin`和`guest`这两个对象。我们只想将`user`里有的东西在用一下，不是拷贝、重现这些方法，只想在其上构造一个新的对象。

原型继承是语言特性之一，正是它帮助我们实现这点。

### [[Prototype]]

JavaScript中，对象有一个特殊被隐藏的属性`[[Prototype]]`(规范中这样命名)，它要么是`null`，要么就是引用另一个对象。那个被引用的对象就是远行对象。

<img src="http://javascript.info/article/prototype-inheritance/object-prototype-empty@2x.png">

`[[Prototype]]`属性有一个神奇的意义。每当我们想从`object`上读取一个没有的属性，JavaScript会自动的去原型上那这个属性。这就是”原型继承”。许多不错的语言特性和编程技巧都基于它。

`[[Prototype]]`是内部隐藏的属性，但有许多方法去设置它。

使用`__proto__`就是其中的方法之一，like this:

```javascript
let animal = {
  eats: true
};
let rabbit = {
  jumps: true
};

rabbit.__proto__ = animal;
```

注意：`__proto__`和`[[Prototype]]`不一样，它只是原型的`get/set`方法。随后，我们会讲其他的设置方法，现在就用`__proto__`吧！

如果你想在`rabbit`上找一个它没有的属性，JavaScript会自动在`animal`上找。

例子如下：

```javascript
let animal = {
  eats: true
};
let rabbit = {
  jumps: true
};

rabbit.__proto__ = animal; // (*)

// we can find both properties in rabbit now:
alert( rabbit.eats ); // true (**)
alert( rabbit.jumps ); // true
```

有`（*）`的这行，将`rabbit`的原型指向了`animal`。

当我们想`alert(rabbit.eats)`时，`rabbit`里面没有这个属性，所以JS根据原型引用地址找到了`animal`上的`eats`属性，如果往上找原型。

<img src="http://javascript.info/article/prototype-inheritance/proto-animal-rabbit@2x.png">

所以我们能说：`animal`是`rabbit`d的原型对象。

如果在`animal`上有很多有用的属性和方法，他们在`rabbit`上也同样生效。这就是被继承的属性。

如果我们在`animal`上有一个属性，它同样能在`rabbit`上调用。

```javascript
let animal = {
  eats: true,
  walk() {
    alert("Animal walk");
  }
};

let rabbit = {
  jumps: true,
  __proto__: animal
};

// walk is taken from the prototype
rabbit.walk(); // Animal walk
```

方法就像下图演示的一样，被JS自动拿到：

<img src="http://javascript.info/article/prototype-inheritance/proto-animal-rabbit-walk@2x.png">

原型链还能载长：

```JavaScr
let animal = {
  eats: true,
  walk() {
    alert("Animal walk");
  }
};

let rabbit = {
  jumps: true,
  __proto__: animal
};

let longEar = {
  earLength: 10,
  __proto__: rabbit
}

// walk is taken from the prototype chain
longEar.walk(); // Animal walk
alert(longEar.jumps); // true (from rabbit)
```

<img src="http://javascript.info/article/prototype-inheritance/proto-animal-rabbit-chain@2x.png">

实际上，有两点限制：

1. 引用不能是闭环（不能是一个环装）。JS会报错，如果你这样做的话。
2. `__proto__`的值可以是一个对象也可以是`null`。其余的类型的值会被忽略。

原型是清楚的，每一个对象只能有一个`[[Protoype]]`。也就是说一个对象不能继承与两个不同的对象。